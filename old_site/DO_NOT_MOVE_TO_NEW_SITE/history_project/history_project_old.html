<h3 dir="auto">Проект</h3>
<p dir="auto">Головная организация и ее дилеры. Дилеры заказывают, продают товары  и оказывают услуги предоставляемые центром.
    Дилерам назначаются планы реализации. Нужно отслеживать выполнение этих планов, остатков. Организовать документооборот между
    дилерами и головной организацией. Дилеры раскиданы по всей стране. </p>
<hr id="system-readmore"/>
<h3 dir="auto">Текущая архитектура</h3>
<p>Karaf в микросервисе kubrenetes. Жирное, хоть и модульное(плагинное) приложение в микросервисе кубера. Часть функций
    реализована во внешних системах.</p>
<h3 dir="auto">Команда</h3>
<p dir="auto">1 тимлид<br/>2 аналитика<br/>3 backend разработчика (java)<br/>3 frontend разработчика (react)<br/>3
    тестировщика<br/>2 devops инженера<br/>Итого: 14 чел<br/><br/>Вполне нормальная команда, не перенаселена, не 30
    человек. Backend разработчики и один из devops инженеров работали на двух проектах в параллель. Параллельные проекты
    никак не связаны с текущим проектом, ни заказчиком, ни командой и т.п.</p>
<h3 dir="auto">Что было сделано</h3>
<p dir="auto">Ушли от karaf. Полностью перешли на действительно МИКРОсервисы, а не karaf в микросервисе и не
    микросервисы в karaf.</p>
<p dir="auto"> Бизнес логику разместили в camunda. Для этого очень плотно пришлось поработать с заказчиком через аналитиков.
    Это было не очень просто. Моя основная роль backend-разработчик (по крайней мере мне так казалось).
    Нужно было из массы требований, описанных в разных частях, как-то скомпилировать все вместе, затем разложить по полочкам,
    увидеть <b>отдельные</b> процессы, а затем придумать как это все можно реализовать. При этом, что-то уже было написано до меня.
    Camunda тоже очень не сразу зашла. Сначала для себя ответить на вопрос: "А точно потянет?". Потом познакомить с ней и разработчиков и аналитиков, чтобы прониклись ее возможностями.
    Донести до заказчика мысль, что автоматизация обязательно поменяет обязанности его сотрудников.
</p>

<p>Пример <b>одного из</b> бизнес процессов системы (их несколько получилось):</p>
<p><span style="font-weight: 400;"> <img class="pull-center" src="images/camunda_proj.png" alt=""/></span></p>
(очень отдельная тема - выделить бизнес-процессы, сделать их более-менее нестрашными)
<p dir="auto">Внутри kubernetes микросервисы разделили на несколько групп (что-то типа mvc для kubernetes):</p>
<ul dir="auto">
    <li>для доступа извне(rest)</li>
    <li>для доступа к собственным базам данных</li>
    <li>бизнес сервисы (<b>вся бизнес логика разместилась в сервисах camunda</b>)</li>
    <li>для общения с внешними системами (почта, авторизация и пр. внешние бизнес системы)</li>
</ul>
<p dir="auto">Раньше все это было размазано по karaf!</p>
<p dir="auto">Для обмена между микросервисами использовали не только REST, но и очереди.</p>
<p dir="auto">Выделили в отдельную библиотеку(DTO) форматы обмена с системой. Настроили оповещение фронт разработчиков
    (да и всей команды) при изменении в этом слое. Внутри библиотеки DTO сделали 2 слоя "dto-short" для краткого
    описания бизнес сущностей (id:integer, name:string ...) и dto-full с полным описанием. При этом фронтенд разработчики точно знали "правила игры" (связь dto-rest, схема/скелет типичного REST-контроллера). Зная "правила игры" могли начинать разработку нового интерфейса не дожидаясь backend-а.</p>
<p dir="auto">Для обмена между микросервисами <b>внутри</b> kubernetes использовали отдельную библиотеку DTO.</p>
<p dir="auto">Сложно было с <b>интеграционным</b> тестированием. Пришлось плотно работать с тестировщиками. А именно, убедить их отказаться от Postman в пользу автоматизированных средств тестирования
    (<a style="text-decoration: underline; color: #3366ff;"
       title="behave-restful"
       href="https://github.com/behave-restful/behave-restful"
       target="_blank" rel="noopener noreferrer">behave-restful</a>,
    <a style="text-decoration: underline; color: #3366ff;"
       title="Интеграционное тестирование REST"
       href="https://v.perm.ru/main/index.php/34-behave-testirovanie"
       target="_blank" rel="noopener noreferrer">Интеграционное тестирование REST</a>).

<h3 dir="auto">И что?</h3>
<p dir="auto">Для чего все это написано? Описаны какие-то мелкие служебные микросервисы, что-то про команду... Хотелось
    показать подход к разработке, как мне кажется, очень типового проекта. Вся функциональность системы спряталась в
    бизнес процессы camunda. В те самые "кубики" camunda. А все остальное несложная типовая обвязка.</p>
<p dir="auto">Появилась возможность функционального тестирования каждого микросервиса на машине разработчика без поднятия всего окружения.
    Что-то типа unit тестирования, но для микросервиса.</p>

<a style="text-decoration: underline; color: #3366ff;"
   title="О бизнес процессах вообще и Camunda в частности"
   href="https://v.perm.ru/main/index.php/43-o-biznes-protsessakh-voobshche-i-camunda-v-chastnosti"
   target="_blank" rel="noopener noreferrer">О бизнес процессах вообще и Camunda в частности
</a>
<br/>

