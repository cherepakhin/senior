<p>В заметке описаны инструменты автоматизированного BDD тестирования REST и примеры использования.
    Тесты проведены на простом REST сервисе
    <a style="text-decoration: underline; color: #3366ff;"
       title="https://github.com/cherepakhin/animals"
       href="https://github.com/cherepakhin/animals"
       target="_blank" rel="noopener noreferrer">https://github.com/cherepakhin/animals</a>
</p>
<p><b>А чем, собственно, проблема?</b></p>
<hr id="system-readmore"/>
На тех проектах, где работал, тестировщики в основном использовали <b>ручное</b> тестирование.
И даже больше - интеграционное тестирование backend как-то не очень-то и проводится.
Тут и философия scrum "помогает" не тратить много время на тестирование,
когда каждый релиз выпускается с какими-то оговорками. И, с другой стороны, ограничения службы безопасности и т.д. и т.п.
Мне, как разработчику backend, интересно протестировать сервис, а конкретно REST, со стороны backend.
И unit тесты тут не помогут. Ручное тестирование (Postman, httpie) только для каких-то разовых операций.
Нужно автоматизированное тестирование REST.
<br/>
<p><b>Behave-restful (Python!)</b></p>
<a style="text-decoration: underline; color: #3366ff;"
   title="https://github.com/behave-restful/behave-restful"
   href="https://github.com/behave-restful/behave-restful"
   target="_blank" rel="noopener noreferrer">https://github.com/behave-restful/behave-restful</a>
<br/>
<p>Первый МОЩНЫЙ инструмент, который нашел, и в котором было все, что нужно. Но Python.
    Тестировщик должен его знать и корпоративные условия (секьюрность, сам python, библиотеки) должны позволять его использовать.</p>
А сам инструмент фантастика! Понятно, что появились наследники.

<p><b>Простое тестирование JUnit5 с выводом результатов в Allure</b></p>
Для общения с Rest можно использовать н.п. RestTemplate.
Примеры тестирования <a style="text-decoration: underline; color: #3366ff;"
                        title="https://javabydeveloper.com/junit-5-with-allure-reports-example/"
                        href="https://javabydeveloper.com/junit-5-with-allure-reports-example/"
                        target="_blank" rel="noopener noreferrer">https://javabydeveloper.com/junit-5-with-allure-reports-example/</a>.
В примере очень подробно описана работа с Allure, с различными группировками и прочими возможностями.
<br/>
<p>Проведение тестов:</p>
<pre class="language-shell">
<code>git clone https://github.com/javabydeveloper/Junit-5-tutorials-master/tree/master/junit5-allure-report-example
cd junit5-allurreport-example
mvn clean test allure:report</code>
</pre>
<br/>
<p><i>Необходимое замечание</i></p>
Нужно обеспечить начальное состояние теста и восстановить состояние после любого исхода теста. В самом простом случае можно установить его прямо в тесте. Или, лучше, воспользоваться средствами JUnit5:
<ul>
    <li>@BeforeAll - выполняется ПЕРЕД выполнением ВСЕХ методов класса теста</li>
    <li>@BeforeEach - выполняется ПЕРЕД выполнением КАЖДОГО метода класса теста</li>
    <li>@AfterEach - выполняется ПОСЛЕ выполнением КАЖДОГО метода класса теста</li>
    <li>@AfterAll - выполняется ПОСЛЕ выполнением ВСЕХ методов класса теста</li>
</ul>

<p><b>JBehave</b></p>
<a style="text-decoration: underline; color: #3366ff;"
   title="https://jbehave.org/"
   href="https://jbehave.org/"
   target="_blank" rel="noopener noreferrer">https://jbehave.org/</a>
<br/>
<p>Описание...</p>

<p><b>RestAssured</b></p>
<a style="text-decoration: underline; color: #3366ff;"
   title="https://rest-assured.io/"
   href="https://rest-assured.io/"
   target="_blank" rel="noopener noreferrer">https://rest-assured.io/</a>
<br/>
<a style="text-decoration: underline; color: #3366ff;"
   title="https://github.com/cherepakhin/animals-rest-assured-test"
   href="https://github.com/cherepakhin/animals-rest-assured-test"
   target="_blank" rel="noopener noreferrer">Пример использования</a>
<br/>
<p>Описание...</p>

<hr/>
<p><b>Вопросы на ктр. не очень-то и отработаны (МНОЙ!):</b></p>
<p>Это не UNIT тесты, это интеграционные тесты. При обычном UNIT тестировании,
можно откатить, например, состояние базы данных установкой режима транзакций. Но интеграционное тестирование это не только база данных.</p>
<p>И всегда-ли возможно установить состояние базы данных в состояние на ктр. расчитывает тест (что-то типа "mvn flyway:migrate")?
    И что такое начальное состояние БД для конкретного теста?</p>
<p>Другие внешние ресурсы (очереди, авторизация, др. смежные сервисы). Как-то бы мокать все эти дела или использовать <b>@Before..</b>/<b>@After..</b></p>
<p>Похож на предыдущий пункт - тестирование бизнес ПРОЦЕССОВ и уже УСТАНОВЛЕНОГО ГДЕ-ТО СОСТОЯНИЯ процесса.</p>
<p>Всякие мелочи типа валидатора JSON схемы и т.п. (Конкретно, для JSON, например, есть такой
<a style="text-decoration: underline; color: #3366ff;"
   title="https://github.com/networknt/json-schema-validator"
   href="https://github.com/networknt/json-schema-validator"
   target="_blank" rel="noopener noreferrer">https://github.com/networknt/json-schema-validator</a>.

Пример использования
<a style="text-decoration: underline; color: #3366ff;"
   title="Пример использования"
   href="https://www.baeldung.com/introduction-to-json-schema-in-java"
   target="_blank" rel="noopener noreferrer">https://www.baeldung.com/introduction-to-json-schema-in-java/</a>
)
</p>

Много примеров в самых разных вариантах тестирования (Java, Kotlin, JUnit4, JUnit5, Gradle, Maven ...) с выводом в Allure Reports:
<a style="text-decoration: underline; color: #3366ff;"
   title="https://github.com/allure-examples"
   href="https://github.com/allure-examples"
   target="_blank" rel="noopener noreferrer">https://github.com/allure-examples</a>

