<b>Dagger</b> — фреймворк для внедрения зависимостей (Dependency Injection, DI) в приложения на платформе Java. Разрабатывался компанией Square, но сейчас поддерживается <b>Google</b>.<br/>
Документация: <a style="text-decoration: underline; color: #3366ff;" href="https://dagger.dev/dev-guide/" target="_blank" rel="noopener noreferrer">https://dagger.dev/dev-guide/</a><br/>
Github: <a style="text-decoration: underline; color: #3366ff;" href="https://square.github.io/dagger/" target="_blank" rel="noopener noreferrer">https://square.github.io/dagger/</a><br/>
<br/>
Очень примитивный пример: <a style="text-decoration: underline; color: #3366ff;" href="https://github.com/cherepakhin/dagger_simplest" target="_blank" rel="noopener noreferrer">https://github.com/cherepakhin/dagger_simplest</a><br/>
Hello World: <a style="text-decoration: underline; color: #3366ff;" href="https://github.com/cherepakhin/dagger_hello_world" target="_blank" rel="noopener noreferrer">https://github.com/cherepakhin/dagger_hello_world</a><br/>

<h3>Задачи Dagger</h3>

<ul>
    <li>Автоматическое внедрение зависимостей в объекты (классы, интерфейсы, контексты и другие объекты);</li>
    <li>Управление жизненным циклом зависимостей;</li>
    <li>Создание синглтонов (единственных экземпляров) или одноразовых зависимостей (создаются новые экземпляры при каждом запросе);</li>
    <li>Обработка сложных зависимостей;</li>
    <li>Модульное тестирование (возможность заменять реальные зависимости на фиктивные или подставные объекты).</li>
</ul>
<hr id="system-readmore" />

<h3>Особенности</h3>
<ul>
    <li>проверяет зависимости на этапе компиляции, в отличие от некоторых других фреймворков, которые используют рефлексию;</li>
    <li>генерирует код, который обрабатывает создание и предоставление зависимостей в соответствии с определёнными правилами;</li>
</ul>

<h3>Аннотации</h3>

Dagger использует аннотации, чтобы пометить классы и методы, которые участвуют в процессе внедрения зависимостей. Некоторые распространённые аннотации:
<ul>
    <li><b>@Module</b> — отмечает модули и классы программного средства (<a style="text-decoration: underline; color: #3366ff;" href="https://github.com/cherepakhin/dagger_hello_world/blob/master/src/main/java/com/sample/app/modules/DependenciesProviderModule.java" target="_blank" rel="noopener noreferrer">com.sample.app.modules.DependenciesProviderModule.java</a>) (аннотация класса).</li>
    <li><b>@Provides</b> — этой аннотацией помечаются методы предоставления зависимостей внутри модулей (<a style="text-decoration: underline; color: #3366ff;" href="https://github.com/cherepakhin/dagger_hello_world/blob/master/src/main/java/com/sample/app/modules/DependenciesProviderModule.java" target="_blank" rel="noopener noreferrer">com.sample.app.modules.DependenciesProviderModule.java</a>) (аннотация метода).</li>
    <li><b>@Named</b> - используется вместе с @Provides для установки имени <b>предоставляемого</b>  бина
        <div style="background: #ffffff; overflow: auto; width: auto; border: solid #092A8F; border-width: .1em .1em .1em .8em; padding: .2em .6em;">
<pre style="margin: 0; line-height: 125%;">@dagger.Provides
@javax.inject.Named("sql") // предоставление зависимости с именем "sql"
public static DataSource provideMySqlDataSource() {...}
</pre>
        </div>
        и в классе, который <b>использует</b> зависимость:
        <div style="background: #ffffff; overflow: auto; width: auto; border: solid #092A8F; border-width: .1em .1em .1em .8em; padding: .2em .6em;">
<pre style="margin: 0; line-height: 125%;">@Inject
public DataPrinter(@Named("sql") com.sample.app.interfaces.DataSource sqlSource,
        @Named("file") com.sample.app.interfaces.DataSource fileSource) { ... }
</pre>
        </div>

    </li>
    <li><b>@Component</b> — используется для <b>интерфейса</b>, который объединяет части процесса внедрения зависимостей (<a style="text-decoration: underline; color: #3366ff;" href="https://github.com/cherepakhin/dagger_hello_world/blob/master/src/main/java/com/sample/app/components/DataPrinterComponent.java" target="_blank" rel="noopener noreferrer">com.sample.app.components.DataPrinterComponent.java</a>) (аннотация класса).</li>
    <li><b>@Inject</b> — метка запроса зависимостей, которые должны быть предоставлены фреймворком для внедрения. Может использоваться с конструктором класса, полями класса или методами (<a style="text-decoration: underline; color: #3366ff;" href="https://github.com/cherepakhin/dagger_hello_world/blob/master/src/main/java/com/sample/app/util/DataPrinter.java" target="_blank" rel="noopener noreferrer">com.sample.app.util.DataPrinter.java</a>) (аннотация метода).</li>
</ul>

Дополнительно понадобятся аннотации из javax.inject:
<ul>
    <li>@Inject - для конструкторов и полей классов (аннотация метода)</li>
    <li>@Singleton - для синглтонов @Provides (аннотация метода)</li>
</ul>
<a style="text-decoration: underline; color: #3366ff;" href="https://www.baeldung.com/dagger-2" target="_blank" rel="noopener noreferrer">Introduction to Dagger 2 (www.baeldung.com)</a>

<h3>Использование на примере</h3>
Hello world: <a style="text-decoration: underline; color: #3366ff;" href="https://github.com/cherepakhin/dagger_hello_world" target="_blank" rel="noopener noreferrer">https://github.com/cherepakhin/dagger_hello_world</a>

<ul>
    <li><b>@Module</b> — (см.использование ниже в @Provides) отмечает модули и классы программного средства <a style="text-decoration: underline; color: #3366ff;" href="https://github.com/cherepakhin/dagger_hello_world/blob/master/src/main/java/com/sample/app/modules/DependenciesProviderModule.java" target="_blank" rel="noopener noreferrer">@dagger.Module DependenciesProviderModule.java</a>.</li>
    <li><b>@Provides</b> — этой аннотацией помечаются методы предоставления зависимостей внутри модулей (<a style="text-decoration: underline; color: #3366ff;" href="https://github.com/cherepakhin/dagger_hello_world/blob/master/src/main/java/com/sample/app/modules/DependenciesProviderModule.java" target="_blank" rel="noopener noreferrer">@dagger.Module DependenciesProviderModule.java</a>).
        <div style="background: #ffffff; overflow: auto; width: auto; border: solid #092A8F; border-width: .1em .1em .1em .8em; padding: .2em .6em;">
<pre style="margin: 0; line-height: 125%;">
package com.sample.app.modules;

import javax.inject.Named;

import com.sample.app.interfaces.DataSource;
import com.sample.app.interfaces.impl.FileDataSource;
import com.sample.app.interfaces.impl.MySQLDataSource;

import dagger.Module;
import dagger.Provides;

/**
 * Предоставляет реализации зависимостей с именами "file" и "sql"
 * зависимости используется в DataPrinter
 */
<b>@Module</b>
public class DependenciesProviderModule {

    // Реализация зависимости и внесение в контекст (@dagger.Provides) с именем "sql" (@Named("sql"))
    // используется в DataPrinter через @Inject --> @javax.inject.Named("sql") DataSource sqlSource
    <b>@Provides</b> // @Provides - для внесения зависимости в контекст
    <b>@Named("sql")</b>    // внесение в контекст bean с именем "sql"
    public static DataSource provideMySqlDataSource() {
        return new MySQLDataSource();
    }

    <b>@Provides</b>
    <b>@Named("file")</b>
    public static DataSource provideFileDataSource() {
        return new FileDataSource();
    }
}
</pre></div>
    </li>
    <li><b>@Component</b> — <b>интерфейс</b>, который объединяет части процесса внедрения зависимостей<br/>
        <a style="text-decoration: underline; color: #3366ff;" href="https://github.com/cherepakhin/dagger_hello_world/blob/master/src/main/java/com/sample/app/components/DataPrinterComponent.java" target="_blank" rel="noopener noreferrer">@Component<br/>DataPrinterComponent</a>
        <div style="background: #ffffff; overflow: auto; width: auto; border: solid #092A8F; border-width: .1em .1em .1em .8em; padding: .2em .6em;">
<pre style="margin: 0; line-height: 125%;">
package com.sample.app.components;

import com.sample.app.modules.DependenciesProviderModule;
import com.sample.app.util.DataPrinter;

import dagger.Component;
import dagger.Module;

// Используется в App.java как:
// DataPrinterComponent dataPrinterComponent = DaggerDataPrinterComponent.builder().build();

// Реализация В DependenciesProviderModule.java так:
// @Module
// public class DependenciesProviderModule
<b>@Component(modules = {DependenciesProviderModule.class})</b>
public interface DataPrinterComponent {

    DataPrinter dataPrinter();

}
</pre></div>
    </li>
    <li><b>@Inject</b> — метка зависимостей, которые должны быть предоставлены фреймворком для внедрения. Может использоваться с конструктором класса, полями класса или методами <a style="text-decoration: underline; color: #3366ff;" href="https://github.com/cherepakhin/dagger_hello_world/blob/master/src/main/java/com/sample/app/util/DataPrinter.java" target="_blank" rel="noopener noreferrer">DataPrinter.java</a>.
        (@Named - используется для <b>точного</b> указания имени зависимости, т.к. в контексте две реализации одного интерфейса)<br/>
        <div style="background: #ffffff; overflow: auto; width: auto; border: solid #092A8F; border-width: .1em .1em .1em .8em; padding: .2em .6em;">
<pre style="margin: 0; line-height: 125%;">
package com.sample.app.util;

import javax.inject.Inject;
import javax.inject.Named;

public class DataPrinter {

    private com.sample.app.interfaces.DataSource sqlSource;

    private com.sample.app.interfaces.DataSource fileSource;

    // В конструктор инжектируются (@javax.inject) 2 бина с @Named("sql") и @Named("file")
    // Предоставляет их DependenciesProviderModule через @Provides(@dagger.Provides)
    // с именами (@Named("sql") и @Named("file"))

    <b>@Inject</b>
    public DataPrinter(<b>@Named("sql")</b> com.sample.app.interfaces.DataSource sqlSource,
                       <b>@Named("file")</b> com.sample.app.interfaces.DataSource fileSource) {
        this.sqlSource = sqlSource;
        this.fileSource = fileSource;
    }

    public void print() {
        System.out.println("------------------------\nDataPrinter.print:");
        try {
            System.out.println("dataFromSQL: " + getDataFromSQL());
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
        try {
            System.out.println("dataFromFile: " + getDataFromFile());
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
    }

    public String getDataFromSQL() throws Exception {
        if (sqlSource == null) {
            throw new Exception("sqlSource is null");
        }
        return sqlSource.read();
    }

    public String getDataFromFile() throws Exception {
        if (fileSource == null) {
            throw new Exception("fileSource is null");
        }
        return fileSource.read();
    }

}
</pre></div>
    </li>
</ul>


<a style="text-decoration: underline; color: #3366ff;" href="https://github.com/cherepakhin/dagger_hello_world/blob/master/src/main/java/com/sample/app/modules/DependenciesProviderModule.java" target="_blank" rel="noopener noreferrer">@Module DependenciesProviderModule.java</a>
объявляет два сервиса <b>@Provides @Named("sql")</b> и <b>@Provides @Named("file")</b>.


Эти сервисы используются в
<a style="text-decoration: underline; color: #3366ff;" href="https://github.com/cherepakhin/dagger_hello_world/blob/master/src/main/java/com/sample/app/util/DataPrinter.java" target="_blank" rel="noopener noreferrer">com.sample.app.util.DataPrinter</a> (см.выше).


И вызываются в
<a style="text-decoration: underline; color: #3366ff;" href="https://github.com/cherepakhin/dagger_hello_world/blob/master/src/main/java/com/sample/app/App.java" target="_blank" rel="noopener noreferrer">src/main/java/com/sample/app/App.java</a>:

<div style="background: #ffffff; overflow: auto; width: auto; border: solid #092A8F; border-width: .1em .1em .1em .8em; padding: .2em .6em;">
<pre style="margin: 0; line-height: 125%;">
public class App {

    public static void main(String[] args) {
        // DaggerDataPrinterComponent - generated class by Dagger from interface DataPrinterComponent
        DataPrinterComponent dataPrinterComponent = DaggerDataPrinterComponent.builder().build();
        DataPrinter dataPrinter = dataPrinterComponent.dataPrinter();

        dataPrinter.print();
    }

}
</pre></div>

<b>Ссылки:</b>
<ul>
    <li><a style="text-decoration: underline; color: #3366ff;" href="https://dagger.dev/dev-guide/" target="_blank" rel="noopener noreferrer">Dagger dev guide</a></li>
    <li><a style="text-decoration: underline; color: #3366ff;" href="https://dagger.dev/dev-guide/" target="_blank" rel="noopener noreferrer">Dagger dev guide</a></li>
    <li><a style="text-decoration: underline; color: #3366ff;" href="https://square.github.io/dagger/" target="_blank" rel="noopener noreferrer">A fast dependency injector for Android and Java</a></li>
</ul>