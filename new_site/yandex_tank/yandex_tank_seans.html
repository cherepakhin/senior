Показаны настройки теста с помощью Docker.
<hr id="system-readmore" />
Скрипт для запуска тестов ~/prog/yandex-tank/tank-run.sh
<div style="background: #ffffff; overflow:auto;width:auto;border:solid #092A8F;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%">$ ~/prog/yandex-tank/tank-run.sh
....Тут лог тестов....
</pre></div>

Содержимое скрипта:
<div style="background: #ffffff; overflow:auto;width:auto;border: solid #092A8F;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%">$ cat tank-run.sh
docker run --entrypoint yandex-tank <span style="color: #0000FF">\</span>
-v <span style="color: #000080; font-weight: bold">$(</span>pwd<span style="color: #000080; font-weight: bold">)</span>:/var/loadtest <span style="color: #0000FF">\</span>
-v $SSH_AUTH_SOCK:/ssh-agent -e SSH_AUTH_SOCK=/ssh-agent <span style="color: #0000FF">\</span>
--net host <span style="color: #0000FF">\</span>
-it direvius/yandex-tank
</pre></div>
Пояснения:<br/>
<b>-v $(pwd):/var/loadtest</b> монтируется текущий каталог (со всем в нем файлами) к docker в каталог /var/loadtest.
В каталоге <b>~/prog/yandex-tank</b> (получение текущего каталога через $(pwd)) должен быть файл <b>load.yaml</b> с описанием теста:
<div style="background: #ffffff; overflow:auto;width:auto;border: solid #092A8F;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%">$ cat load.yaml
overload:
enabled: true
package: yandextank.plugins.DataUploader
token_file: token.txt
phantom:
address: 192.168.1.57:8980
load_profile:
load_type: rps
schedule: const(1000, 20s)
ammofile: /var/loadtest/ammo-uri.txt
ammo_type: uri
console:
enabled: true
telegraf:
config: monitoring.xml
enabled: true
kill_old: false
package: yandextank.plugins.Telegraf
ssh_timeout: 5s
</pre></div>
<b>const(1000, 20s)</b> - Нагрузка постоянная 1000rps в течении 20 сек.<br/>
<b>address: 192.168.1.57:8980</b> - по какому хосту стрелять. Только адрес хоста (url в ammo.txt).<br/>
<b>/var/loadtest/ammo-uri.txt</b> - по каким url стрелять. Может быть список url. В ammo.txt url указываются без адреса хоста.<br/>
Urls для расстрела (ammo-uri.txt):
<div style="background: #ffffff; overflow:auto;width:auto;border:solid #092A8F;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%">~/prog/yandex-tank$ cat ammo-uri.txt
[Connection: close]
[Cookie: None]
/test/echo?name=STATIC
/test/dynamic?name=DYNAMIC
/test/spring?name=SPRING
</pre></div>
Итого. Будет стрельба по http://192.168.1.57:8980/test/echo?name=STATIC, http://192.168.1.57:8980/test/dynamic?name=DYNAMIC, http://192.168.1.57:8980/test/spring?name=SPRING
с ПООСТОЯННОЙ (<b>schedule: const</b>) нагрузкой <b>1000rps</b> в течении <b>20 сек.</b>
<br/>
Это только один из вариантов тестирования, остальные детали описаны в документации.<br/>
При проведении теста, будет выведена картинка в консоли о ходе теста
<p><img style="display: block; margin-left: auto; margin-right: auto;" title="show_test.png" src="images/yandex_tank/show_test.png" alt="show_test" /></p>
В Grafana выглядит так:
<p><img style="display: block; margin-left: auto; margin-right: auto;" title="result_test_in_grafana" src="images/yandex_tank/result_test_in_grafana.png" alt="result_test_in_grafana.png" /></p>
<br/>
На картинке выбрано только отображение нагрузки на CPU. Метрик и отчетов много всяких (память, сеть и т.п.).<br/>
Yandex-tank это не просто инструмент, это <b>сервис</b>. Результаты тестирования отпраляются, хранятся, отображаются в облаке yandex-tank. Не локально на компьютере пользователя.<br/>
Ссылки:<br/>
<a style="text-decoration: underline; color: #3366ff;"
   title="https://github.com/yandex/yandex-tank"
   href="https://github.com/yandex/yandex-tank"
   target="_blank" rel="noopener noreferrer">https://github.com/yandex/yandex-tank</a><br/>
<a style="text-decoration: underline; color: #3366ff;"
   title="https://github.com/cherepakhin/shop_kotlin_yandex_tank_test"
   href="https://github.com/cherepakhin/shop_kotlin_yandex_tank_test"
   target="_blank" rel="noopener noreferrer">https://github.com/cherepakhin/shop_kotlin_yandex_tank_test</a><br/>